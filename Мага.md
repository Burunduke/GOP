# Создание ортофотоплана на основе гиперспектральной съемки

1. Конвертировать bil в tiff, как-то заебенить в metashape, достать оттуда готовый ортофотоплан и приебенить к остальным каналам. [Хуйня 1](https://www.geoscan.ru/ru/blog/sovmestnaya-obrabotka-materialov-aerofotosemki-s-kamer-vidimogo-diapazona-rgb-i-blizhnego-ik),   
2. При помощи открытого репозитория OpenDroneMap сделать всю хуйню. [Гит](https://github.com/OpenDroneMap/ODM/tree/master), [статья](https://gis-lab.info/qa/opendronemap-intro.html#OpenDroneMap)

[bill в tiff](https://community.esri.com/t5/data-management-questions/converting-hundreds-of-bil-hdr-rasters-to-tiff/td-p/139758) 

# Основные этапы работы

### Импорт и предварительная обработка гиперспектральных данных

1. Коррекция радиометрии / калибровка  
2. Шумоподавление, выравнивание спектров

### Геопривязка изображений к координатам дрона

1. Использование GPS-логов с полета (координат расположения камеры на каждом снимке)  
2. Учет ориентации камеры (если есть IMU данные)  
3. Визуальное выравнивание снимков

### Мозаика (ортомозаика) из нескольких изображений

1. Геотипизация, ортокоррекция  
2. Сшивка и выравнивание изображений с учетом пересечений  
3. Экспорт итогового ортофотоплана

# Open source инструменты и библиотеки

### 1\. Работа с гиперспектральными изображениями

Hyperspectral Python (HyTools)  
Библиотека на Python для работы с гиперспектральными данными (чтение файлов, визуализация, базовая обработка)

### 2\. ENVI .hdr и .dat файлы: GDAL поддержка

PIKaL часто сохраняет гиперспектральные данные в ENVI формате, который полностью поддерживается GDAL  
Можно читать и конвертировать снимки через GDAL команды или библиотеки (osgeo/gdal)

### 3\. Spectral Python (SPy)

Для анализа гиперспектральных изображений, индексации, визуализации и преобразований

# 2\. Геокоррекция и ортофотоплан:

#### 1\. OpenDroneMap (ODM)

Один из самых популярных opensource фотограмметрических пайплайнов для обработки дроновых снимков  
В основном предназначен под RGB/мультспектральные данные, но может использоваться при наличии EXIF с GPS координатами  
Создает ортофотовыставы и 3D-модели  
Возможна кастомизация под гиперспектральные данные или отдельные спектральные каналы  
Поддержка колокализации через GPS файлы и полетные данные

#### 2\. MicMac

Мощный open-source фотограмметрический пакет от французских ученых  
Поддерживает сложные фотограмметрические задачи, работу со съемками с воздуха  
Требует скриптов и настроек (есть учебные материалы)  
Можно подключать внешние GPS+IMU данные  
Подходит для создания ортофотопланов, в том числе из нестандартных данных

#### 3\. OpenMVG \+ OpenMVS

OpenMVG — библиотека для Structure from Motion (SfM)  
OpenMVS — реконструкция 3D поверхностей и ортофото  
Можно использовать если есть достаточное перекрытие снимков  
Нужно будет подключить GPS/IMU самостоятельно и синхронизировать

#### 4\. QGIS

Не фотограмметрический инструмент, но очень удобен для прочих GIS-задач  
Поддерживает работу с гиперспектральными данными через GDAL  
Позволяет наложить GPS треки, геокодировать снимки вручную или скриптами  
Можно сш изображения (частично), создавать мозаики  
Широкий выбор плагинов для аэрофотоснимков и гиперспектра

#### 5\. GRASS GIS

Более продвинутый в части геопривязки и обработки растров  
Можно геокорректировать изображения, сшивать и работать с растрами, обращаться к GPS

# 3\. Обработка GPS / полетных данных

Конвертация текстового файла с координатами в формат, понятный GIS (CSV \-\> GPX или shapefile)  
Используйте Python-библиотеки:  
pandas для чтения и обработки координат  
geopandas — для подготовки геоданных  
pyproj — преобразование систем координат  
В OpenDroneMap и MicMac можно скормить GPS треки для уточнения геопривязки

# 4\. Специализированные инструменты для ортокоррекции с гиперспектралом

#### 1\. Orfeo Toolbox (OTB)

Полноценный набор инструментов для обработки спутниковых и аэро-снимков  
Поддержка гиперспектральных данных  
Мощные алгоритмы геокоррекции, ортофото, мозаики  
Скриптовый интерфейс (Python, C++)  
В связке с GDAL и QGIS отлично подходит для создания ортофото

#### 2\. RSI ENVI

Хотя ENVI не является opensource, стоит упомянуть, что гиперспектральные данные требуют продвинутой обработки  
В opensource аналогах можно использовать инструменты типа Spectral Python \+ OTB/GDAL для основного пайплайна

# Qgis

Позволяет делать дохуя и нихуя одновременно. По идее на нем все можно строить, ибо там python, вся хуйня

# Resonon

Прога для обработки гиперспектральных изображений. Есть только на винде(  
georectify airborne datacube plugin позволил бы сшивать, но он не открытый

# Metashape

Позволяет строить ортофотоплан по обычным снимкам, есть на линуксе. Но гиперспектральные в сделку не входили \+ нужен не bil, а tiff формат

# AVIRIS

Данные как у научника \- не обработанные, просто охуеть какие большие файлы  
https://popo.jpl.nasa.gov/mmgis-aviris/?mission=AVIRIS\&site=ert\&mapLon=-93.95507812500001\&mapLat=40.245991504199026\&mapZoom=4\&globeLon=undefined\&globeLat=undefined\&globeZoom=undefined\&panePercents=0,100,0\&on=e4d92155-7af4-4ec3-ba97-1d6e4639c5d6$1.00,d068949c-3a21-45c0-8aa9-7dd29bfc8adc$1.00\&startTime=2006-04-01T00:00:01.000Z\&endTime=2024-02-15T21:27:02.653Z

# NASA

[https://search.earthdata.nasa.gov/](https://search.earthdata.nasa.gov/)  
Вот тут вроде балдеж, но идем проверять  
и там подвыборка https://glihtdata.gsfc.nasa.gov/

# Open aerial

Кто хочет что хочет кладет и норм  
https://map.openaerialmap.org/\#/-95.33437728881836,30.16566615375297,15/square/023131020233212?\_k=yurbt4