# Научная конфигурация GOP - Гиперспектральная обработка и анализ растений
# Версия 2.0.0 - Чистая научная архитектура без GUI

# Обработка данных
processing:
  max_image_size: 15000
  compression_ratio: 0.125
  batch_size: 32
  num_workers: 4
  orthophoto_resolution: 0.05
  dem_resolution: 0.1
  feature_quality: "high"
  matcher_neighbors: 8
  odm_timeout: 7200  # 2 часа
  
  # Научные параметры обработки
  radiometric_correction:
    method: "empirical_line"  # dark_current, empirical_line, flat_field
    dark_percentile: 1
    bright_percentile: 99
  
  atmospheric_correction:
    enabled: true
    method: "simplified"  # simplified, empirical_line, modtran
  
  noise_reduction:
    method: "pca"  # pca, mnf, wavelet, savgol
    n_components: 0.95
    wavelet_type: "db4"
    wavelet_levels: 2
    savgol_window: 11
    savgol_polyorder: 3
  
  spectral_calibration:
    enabled: true
    resampling: true
    smoothing: true
    standard_ranges:
      blue: [450, 495]
      green: [495, 570]
      red: [620, 750]
      red_edge: [700, 780]
      nir: [750, 1400]
      swir1: [1400, 1800]
      swir2: [2000, 2500]

# Сегментация изображений
segmentation:
  model_path: "models/deeplabv3_resnet101.pth"
  device: "auto"  # auto, cpu, cuda
  confidence_threshold: 0.5
  
  # Параметры каскадной сегментации
  cascade_psp:
    enabled: true
    l_parameter: 500  # Параметр L для CascadePSP
    refinement_threshold: 0.7
  
  # Научные параметры оценки качества
  quality_metrics:
    iou_threshold: 0.5
    dice_threshold: 0.5
    boundary_precision: 0.8

# Вегетационные индексы
indices:
  sensor_types: ["RGB", "Multispectral", "Hyperspectral"]
  
  # Научная классификация индексов
  index_groups:
    greenness: ["GNDVI", "MCARI", "MNLI", "OSAVI", "TVI", "NDVI"]
    stress: ["SIPI2", "mARI", "PRI", "CRI"]
    water: ["NDWI", "MSI", "WI", "NDII"]
    pigment: ["CARI", "PSRI", "SIPI"]
    structure: ["MSR", "MSAVI", "TVI"]
  
  default_indices: [
    "GNDVI", "MCARI", "MNLI", "OSAVI", "TVI",
    "SIPI2", "mARI", "NDWI", "MSI"
  ]
  
  # Спектральные каналы для разных сенсоров
  sensor_bands:
    RGB:
      Blue: 0
      Green: 1
      Red: 2
    
    Multispectral:
      Blue: 0
      Green: 1
      Red: 2
      RedEdge: 3
      NIR: 4
    
    Hyperspectral:
      Blue: 10    # ~450 нм
      Green: 20   # ~550 нм
      Red: 30     # ~650 нм
      RedEdge: 35 # ~720 нм
      NIR: 50     # ~800 нм
      SWIR: 80    # ~1600 нм

# Научный анализ
scientific_analysis:
  enabled: true
  
  # Статистический анализ
  statistics:
    confidence_level: 0.95
    outlier_detection: true
    outlier_method: "iqr"  # iqr, zscore, isolation_forest
  
  # Корреляционный анализ
  correlation:
    method: "pearson"  # pearson, spearman, kendall
    threshold: 0.7
    significance_test: true
  
  # Пространственный анализ
  spatial:
    morans_i: true
    hotspot_analysis: true
    fragmentation_index: true
    spatial_autocorrelation: true
  
  # Классификация состояния растений
  classification:
    method: "threshold"  # threshold, clustering, ml
    thresholds:
      excellent: 0.8
      good: 0.6
      satisfactory: 0.4
      poor: 0.0

# Вывод результатов
output:
  results_dir: "results"
  save_intermediate: true
  output_format: "GeoTIFF"
  
  # Научные отчеты
  scientific_reports:
    enabled: true
    format: "json"  # json, csv, excel
    include_statistics: true
    include_correlations: true
    include_spatial_analysis: true
  
  # Визуализация
  visualization:
    enabled: true
    format: "png"  # png, pdf, svg
    dpi: 300
    colormap: "viridis"
    
    # Типы визуализаций
    types:
      index_maps: true
      condition_maps: true
      correlation_matrices: true
      spatial_patterns: true
      histograms: true

# Логирование
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  file: "logs/gop.log"
  max_size: "10MB"
  backup_count: 5
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  
  # Научное логирование
  scientific_logging:
    enabled: true
    log_processing_steps: true
    log_quality_metrics: true
    log_performance_metrics: true

# Производительность
performance:
  # Память
  memory:
    max_memory_usage: "8GB"
    chunk_size: 1024
    memory_mapping: true
  
  # Параллельная обработка
  parallel:
    enabled: true
    max_workers: 4
    chunk_processing: true
  
  # Кэширование
  cache:
    enabled: true
    cache_dir: "cache"
    max_cache_size: "1GB"
    ttl: 3600  # 1 час

# Валидация и контроль качества
validation:
  enabled: true
  
  # Валидация данных
  data_validation:
    check_missing_values: true
    check_outliers: true
    check_spectral_consistency: true
    min_snr: 10
  
  # Валидация результатов
  result_validation:
    check_georeference: true
    check_projection: true
    check_data_range: true
    check_nodata_values: true

# Интеграция с внешними инструментами
external_tools:
  # OpenDroneMap
  opendronemap:
    enabled: true
    auto_detect: true
    fallback_to_gdal: true
  
  # GDAL
  gdal:
    config_options:
      GDAL_CACHEMAX: "512"
      GDAL_DATA: "/usr/share/gdal"
      CPL_DEBUG: "OFF"

# Экспериментальные функции
experimental:
  enabled: false
  
  # Машинное обучение
  machine_learning:
    enabled: false
    auto_classification: false
    anomaly_detection: false
  
  # Облачная обработка
  cloud_processing:
    enabled: false
    provider: "aws"  # aws, gcp, azure
    auto_scaling: false

# Метаданные
metadata:
  project_name: "GOP - Гиперспектральная обработка и анализ растений"
  version: "2.0.0"
  description: "Научная библиотека для обработки гиперспектральных данных и анализа состояния растений"
  authors:
    - "Индыков Дмитрий Андреевич"
  
  # Научные ссылки
  references:
    - "Митрофанов Е.П., Петрушин А.Ф. Использование данных аэрофотосъемки для обоснования прецизионных агроприемов"
    - "Chen L. et al. Rethinking Atrous Convolution for Semantic Image Segmentation"
    - "CascadePSP: Toward Class-Agnostic and Very High-Resolution Segmentation via Global and Local Refinement"
  
  # Контактная информация
  contact:
    email: "indykovdm@example.com"
    repository: "https://github.com/indykovdm/GOP"